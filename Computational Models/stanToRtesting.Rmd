---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
prevSelf <- c(5,3,5,3,6,5,6,6,4,6,4,6,5,4,3,5,5,4,6,4,5,5,5,6,6,7,5,6,5,5,5,5,7,5,4,4,3,6,5,5,4,5,3,6,3,5,5,5,5,4,5,6,5,5,3,6,5,5,4,3,2,4,3,4,3,5,6,4,6,4,3,6,5,6,3,4,2,5,5,3,2,5,5,4,5,6,5,4,5,5)
m_in <- c(-3.09227)

GPin = rep(1,length(prevSelf))/(1 + exp((-m_in)*(prevSelf-4)));

df <- as.data.frame(rbind(cbind(1,GPin,1:length(GPin)),cbind(2,prevSelf,1:length(prevSelf))))
colnames(df) <- c("type","values","values")

df <- cbind(GPin,prevSelf)
colnames(df) <- c("prob","self")
df <- as.data.frame(df)
ggplot(data=df, aes(x=self, y=prob)) +
  geom_point()
```

```{r}
prevSelf <- c(5,3,5,3,6,5,6,6,4,6,4,6,5,4,3,5,5,4,6,4,5,5,5,6,6,7,5,6,5,5,5,5,7,5,4,4,3,6,5,5,4,5,3,6,3,5,5,5,5,4,5,6,5,5,3,6,5,5,4,3,2,4,3,4,3,5,6,4,6,4,3,6,5,6,3,4,2,5,5,3,2,5,5,4,5,6,5,4,5,5)
PS <- c(0.436782,0.225806,0.258065,0.08,0.0882353,0.0677966,0.352941,0.440678,0.166667,0.166667,0.2,0.17284,0.125,0.290323,0.245614,0.219178,0.213333,0.171429,0.1,0.1,0.163265,0.56,0.26087,0.173077,0.233333,0.358209,0.111111,0.268041,0.32,0.505051,0.413793,0.120482,0.280702,0.28125,0.21875,0.2,0.470588,0.246914,0.32,0.454545,0.358974,0.424242,0.280702,0.314286,0.34375,0.486486,0.229885,0.240964,0.09375,0.295082,0.371429,0.109091,0.0377358,0.0547945,0.303797,0.145455,0.347826,0.217822,0.371134,0.564103,0.2,0.348837,0.235294,0.473684,0.0983607,0.426667,0.558824,0.506024,0.371429,0.210526,0.0408163,0.196721,0.202532,0.109091,0.192771,0.314286,0.230769,0.213333,0.121212,0.504854,0.290909,0.0307692,0.457143,0.192771,0.153846,0.327869,0.412371,0.230769,0.175,0.456522)
GPin1 <- c(0.436782,0.225806,0.258065,0.08,0.0882353,0.0677966,0.352941,0.440678,0.166667,0.166667,0.2,0.17284,0.125,0.290323,0.245614,0.219178,0.213333,0.171429,0.1,0.1,0.163265,0.56,0.26087,0.173077,0.233333,0.358209,0.111111,0.268041,0.32,0.505051,0.413793,0.120482,0.280702,0.28125,0.21875,0.2,0.470588,0.246914,0.32,0.454545,0.358974,0.424242,0.280702,0.314286,0.34375,0.486486,0.229885,0.240964,0.09375,0.295082,0.371429,0.109091,0.0377358,0.0547945,0.303797,0.145455,0.347826,0.217822,0.371134,0.564103,0.2,0.348837,0.235294,0.473684,0.0983607,0.426667,0.558824,0.506024,0.371429,0.210526,0.0408163,0.196721,0.202532,0.109091,0.192771,0.314286,0.230769,0.213333,0.121212,0.504854,0.290909,0.0307692,0.457143,0.192771,0.153846,0.327869,0.412371,0.230769,0.175,0.456522)
params <- c(0.0020753,
1.85619,
1.53044,
0.715145)
simW <- c(0.66852,0.683302)
probs <- c(0.284846,0.715154)
tau <- params[1]
m_in <- params[2]
m_out <- params[3]
bias <- params[4]

GPin = rep(1,length(prevSelf))/(1 + exp((-m_in)*(prevSelf-4)));
GPout = rep(1,length(prevSelf))/(1 + exp((-m_out)*(prevSelf-4)));
```


```{r}
prevSelf <- c(5,3,5,3,6,5,6,6,4,6,4,6,5,4,3,5,5,4,6,4,5,5,5,6,6,7,5,6,5,5,5,5,7,5,4,4,3,6,5,5,4,5,3,6,3,5,5,5,5,4,5,6,5,5,3,6,5,5,4,3,2,4,3,4,3,5,6,4,6,4,3,6,5,6,3,4,2,5,5,3,2,5,5,4,5,6,5,4,5,5)
PS <- c(0.219178,0.416667,0.25,0.277778,0.185185,0.0888889,0.197183,0.311111,0.241379,0.0869565,0.289474,0.208955,0.28,0.208333,0.465116,0.20339,0.0983607,0.0714286,0.217391,0.0869565,0.228571,0.229508,0.290909,0.222222,0.217391,0.301887,0.1,0.313253,0.262295,0.282353,0.318182,0.0869565,0.232558,0.04,0.24,0.212121,0.185185,0.0895522,0.163934,0.384615,0.28125,0.4,0.418605,0.214286,0.28,0.333333,0.164384,0.289855,0.16,0.12766,0.285714,0,0.102564,0.0677966,0.369231,0.439024,0.327273,0.183908,0.337349,0.1875,0.130435,0.25,0.0740741,0.322581,0.0851064,0.163934,0.333333,0.26087,0.357143,0.0930233,0.114286,0.382979,0.246154,0.195122,0.26087,0.285714,0.263158,0.196721,0.0769231,0.314607,0.243902,0.117647,0.285714,0.173913,0.21875,0.297872,0.26506,0.210526,0.272727,0.384615)
GPin1 <- c(0.93185,0.0681502,0.93185,0.0681502,0.99468,0.93185,0.99468,0.99468,0.5,0.99468,0.5,0.99468,0.93185,0.5,0.0681502,0.93185,0.93185,0.5,0.99468,0.5,0.93185,0.93185,0.93185,0.99468,0.99468,0.999609,0.93185,0.99468,0.93185,0.93185,0.93185,0.93185,0.999609,0.93185,0.5,0.5,0.0681502,0.99468,0.93185,0.93185,0.5,0.93185,0.0681502,0.99468,0.0681502,0.93185,0.93185,0.93185,0.93185,0.5,0.93185,0.99468,0.93185,0.93185,0.0681502,0.99468,0.93185,0.93185,0.5,0.0681502,0.00532017,0.5,0.0681502,0.5,0.0681502,0.93185,0.99468,0.5,0.99468,0.5,0.0681502,0.99468,0.93185,0.99468,0.0681502,0.5,0.00532017,0.93185,0.93185,0.0681502,0.00532017,0.93185,0.93185,0.5,0.93185,0.99468,0.93185,0.5,0.93185,0.93185)
GPout1 <- c(0.93185,0.0681502,0.93185,0.0681502,0.99468,0.93185,0.99468,0.99468,0.5,0.99468,0.5,0.99468,0.93185,0.5,0.0681502,0.93185,0.93185,0.5,0.99468,0.5,0.93185,0.93185,0.93185,0.99468,0.99468,0.999609,0.93185,0.99468,0.93185,0.93185,0.93185,0.93185,0.999609,0.93185,0.5,0.5,0.0681502,0.99468,0.93185,0.93185,0.5,0.93185,0.0681502,0.99468,0.0681502,0.93185,0.93185,0.93185,0.93185,0.5,0.93185,0.99468,0.93185,0.93185,0.0681502,0.99468,0.93185,0.93185,0.5,0.0681502,0.00532017,0.5,0.0681502,0.5,0.0681502,0.93185,0.99468,0.5,0.99468,0.5,0.0681502,0.99468,0.93185,0.99468,0.0681502,0.5,0.00532017,0.93185,0.93185,0.0681502,0.00532017,0.93185,0.93185,0.5,0.93185,0.99468,0.93185,0.5,0.93185,0.93185)
params <- c(10,
2.61546,
-2.4038,
0.846932)
simW1 <- c(0.307255,0.69654)
probs1 <- c(5.04121e-05,0.99995)
tau <- params[1]
m_in <- params[2]
m_out <- params[3]
bias <- params[4]

GPin = rep(1,length(prevSelf))/(1 + exp((-m_in)*(prevSelf-4)));
GPout = rep(1,length(prevSelf))/(1 + exp((-m_out)*(prevSelf-4)));

      simW[1] = sum(GPout*PS)/sum(PS);
      simW[2] = sum(GPin*PS)/sum(PS);
      
      prob[1] = ( (1 - bias) * ( ( simW[1] ) ^tau ) ) / ( ( (1 - bias) *  ( simW[1]  ^tau ) ) + ( (bias) * ( ( simW[2] ) ^tau ) ) );
      prob[2] = ( (bias) * ( ( simW[2] ) ^tau ) ) / ( ( (1 - bias) *  ( simW[1]  ^tau ) ) + ( (bias) * ( ( simW[2] ) ^tau ) ) );
```
